{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Search for Your Car!{% endblock %}</h1>
  <a class="action" href="{{ url_for('cars.index') }}">Back to Index</a>
{% endblock %}

{% block content %}
<form id="sort-form" action="{{ url_for('cars.search') }}" method="GET">
  <div class="sort-by">
    <select class="form-control select" id="sort-select" name="sortBy" onchange="this.form.submit()">
      <option value="?">Reset Sort</option>
      {% for name in column_names %}
      <option value="{{ name }}" {% if name == sortBy %} selected {% endif %}>{{ name }}</option>
      {% endfor %}
    </select>
  </div>
</form>  
<form id="filter-form" action="{{ url_for('cars.search') }}" method="GET">
  <div class="filter-by">
    <select class="form-control select" name="model" onchange="this.form.submit()">
      <option value="">All Models</option>
      {% for a in models %}
      <option value="{{ a['model'] }}" {% if a['model'] == model %} selected {% endif %} >{{ a['model'] }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="filter-by">
    <select class="form-control select" name="trim" onchange="this.form.submit()">
      <option value="">All Trims</option>
      {% for a in trims %}
      <option value="{{ a['trim'] }}" {% if a['trim'] == trim %} selected {% endif %}>{{ a['trim'] }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="filter-by">
    <select class="form-control select" name="drive" onchange="this.form.submit()">
      <option value="">All Drives</option>
      {% for a in drives %}
      <option value="{{ a['drive'] }}" {% if a['drive'] == drive %} selected {% endif %}>{{ a['drive'] }}</option>
      {% endfor %}
    </select>
  </div>
</form>

<form action="{{ url_for('cars.text_search_results') }}" method="post">
  <input type="text" name="car" value="search by make, model, trim, or drive">
  <input type="submit" value="Submit">
</form>
{% for car in cars %}
  <article class="cars">
    <header>
      <a class="action" href="{{ url_for('cars.view') }}?car_id={{ car['id'] }}&page={{ page_number }}&key={{ key }}&value={{ value }}&sortBy={{ sortBy }}">  
        <div>
            {% for name in column_names %}
            <div class="about">{{ name }}: {{ car[name] }}</div>
            {% endfor %}
        </div>
      </a>
    </header>
  </article>
  {% endfor %}
  <div class="pagination">
    <a href="{{ url_for('cars.search') }}?page=0&sortBy={{ sortBy }}">first</a>
    <a href="{{ url_for('cars.search') }}?page={{ page_number - 1 }}&sortBy={{ sortBy }}&model={{ model }}&trim={{ trim }}&drive={{ drive }}">prev</a>
    {{ page_number }} of {{ total_pages }}
    <a href="{{ url_for('cars.search') }}?page={{ page_number + 1 }}&sortBy={{ sortBy }}&model={{ model }}&trim={{ trim }}&drive={{ drive }}">next</a>
    <a href="{{ url_for('cars.search') }}?page=-1&sortBy={{ sortBy }}">last</a>
  </div>
{% endblock %}